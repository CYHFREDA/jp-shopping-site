<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8" />
<title>Clevora 後台管理</title>
<script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<link rel="stylesheet" href="css/admin.css" data-href="css/admin.css">
</head>
<body>
<div id="app">
  <!-- 🔹 導覽列 -->
  <nav class="navbar navbar-expand-lg navbar-light bg-warning border-bottom shadow-sm">
    <div class="container-fluid">
      <a class="navbar-brand fw-bold d-flex align-items-center" href="/">
        <img src="images/LOGO.png" alt="LOGO" class="me-2" />
        <span>Clevora 首頁</span>
      </a>
      <div class="ms-auto" v-if="isLoggedIn">
        <span class="navbar-text text-light me-3">後台管理系統</span>
        <button @click="logout" class="btn btn-danger btn-sm">登出</button>
      </div>
    </div>
  </nav>

  <!-- 🔹 登入畫面 -->
  <div v-if="!isLoggedIn" class="container mt-5">
    <div class="card p-4 text-center">
      <h4 class="card-title mb-3">後台登入</h4>
      <p class="text-muted mb-4">請輸入帳號與密碼</p>
      <div class="mb-2">
        <input v-model="loginData.username" class="form-control form-control-lg" placeholder="Username">
      </div>
      <div class="mb-3">
        <input v-model="loginData.password" type="password" class="form-control form-control-lg" placeholder="Password">
      </div>
      <button @click="login" class="btn btn-primary btn-lg w-100">登入</button>
    </div>
  </div>

  <!-- 🔹 主畫面 -->
  <div v-else class="container mt-4">
    <h1>後台管理主頁 (示範 Vue 管理)</h1>
    <!-- 你可以用 v-for 等，讓 Vue 幫你產生訂單/商品清單 -->
  </div>
</div>

<script>
const { createApp } = Vue;
createApp({
  data() {
    return {
      isLoggedIn: false,
      loginData: {
        username: '',
        password: ''
      }
    };
  },
  mounted() {
    const savedToken = localStorage.getItem("basic_token");
    const expireAt = localStorage.getItem("expire_at");
    if (savedToken && expireAt && Date.now() < parseInt(expireAt)) {
      this.isLoggedIn = true;
    }
  },
  methods: {
    async login() {
      if (!this.loginData.username || !this.loginData.password) {
        alert("請輸入帳號密碼！");
        return;
      }
      // 直接用 base64 測試 (示範，實際還需安全處理)
      const token = btoa(`${this.loginData.username}:${this.loginData.password}`);
      const expireAt = Date.now() + (30 * 60 * 1000);
      localStorage.setItem("basic_token", token);
      localStorage.setItem("expire_at", expireAt);
      this.isLoggedIn = true;
      alert("登入成功（示範）");
    },
    logout() {
      if (confirm("確定要登出？")) {
        localStorage.removeItem("basic_token");
        localStorage.removeItem("expire_at");
        this.isLoggedIn = false;
      }
    }
  }
}).mount('#app');
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script src="js/cache-busting.js"></script>
</body>
</html>